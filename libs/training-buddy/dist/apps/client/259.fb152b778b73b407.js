"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[259],{5259:(j,v,n)=>{n.r(v),n.d(v,{ClientEditprofileFeatureModule:()=>J});var g=n(9808),f=n(5357),m=n(1777),h=n(9444),e=n(5e3),s=n(3075),C=n(2160),N=n(4585),A=n(6971),E=n(3954),Z=n(9224),S=n(7423),U=n(5245),p=n(7322),T=n(7531),y=n(4107),F=n(508),b=n(623),x=n(987);function M(o,u){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.updateForm.controls.userNameSurname.errors.error_msg," ")}}function P(o,u){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.updateForm.controls.userEmail.errors.error_msg," ")}}function _(o,u){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.updateForm.controls.userCellNumber.errors.error_msg," ")}}function I(o,u){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.updateForm.controls.userGender.errors.error_msg," ")}}function O(o,u){if(1&o&&(e.TgZ(0,"mat-error"),e._uU(1),e.qZA()),2&o){const t=e.oxw();e.xp6(1),e.hij(" ",t.updateForm.controls.userLocation.errors.error_msg," ")}}const L=function(o){return{"background-image":o}},w=[{path:"",component:(()=>{class o{constructor(t,r,i,a,l){this.frm=t,this.apollo=r,this.cookie=i,this.router=a,this.afStorage=l,this.vicinity="",this.longitude=0,this.latitude=0,this.originalEmail="",this.oldLocation="",this.fileuploadflag=!1,this.fileuploaderror="",this.frmBuilder=t;const d=this.cookie.get("id");this.ref=this.afStorage.ref("UserProfileImage/"+d),this.ref.getDownloadURL().subscribe(c=>{this.currentImage=c})}ngOnInit(){this.updateForm=this.frmBuilder.group({userNameSurname:["",this.validateNameSurname],userEmail:["",this.validateEmail],userCellNumber:["",this.validateCellNumber],userGender:["",this.validateGender],userLocation:["",this.validateLocation]}),this.getCurrentUser().subscribe({next:t=>{this.user=t.data.getOne,this.originalEmail=this.cookie.get("email"),this.longitude=this.user.longitude,this.latitude=this.user.latitude,this.oldLocation=this.user.location,this.updateForm.setValue({userNameSurname:`${this.user.userName} ${this.user.userSurname}`,userEmail:this.user.email,userCellNumber:this.user.cellNumber,userGender:this.user.gender,userLocation:this.user.location})}})}getCurrentUser(){return this.apollo.query({query:h.Ps`query{
        getOne(
          email: "${this.cookie.get("email")}",
      ){
        userName,
        userSurname,
        location,
        longitude,
        latitude,
        dob,
        gender,
        email,
        cellNumber,
        bio,
        metrics{lift , ride , run , swim},
        buddies
      }
      }`})}onAutocompleteSelected(t){this.vicinity=t.vicinity}onLocationSelected(t){null!=t&&(this.latitude=t.latitude,this.longitude=t.longitude)}validateNameSurname(t){return/(([A-Z]|[a-z]))+ ([A-Z]|([a-z]))+/.test(t.value)?null:{error_msg:"Name and surname is required"}}validateSurname(t){return/(([A-Z]|[a-z]))/.test(t.value)?null:{error_msg:"Surname is required"}}validateEmail(t){return/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t.value)?null:{error_msg:"Valid email is required"}}validateCellNumber(t){const i=t.value.replace(/ /g,"");return/^[0-9]{10,10}$/.test(i)?null:{error_msg:"Valid phone number is required"}}validateGender(t){return/[M]|[F]/.test(t.value)?null:{error_msg:"Valid choice required"}}validateLocation(t){return 0==t.value.length?{error_msg:"Location is required"}:null}fileattatched(t){if(0==t.target.files.length&&null!=this.newImage)return;const r=t.target.files[0];if(this.fileuploadflag=!1,!r.type.match(/^image*/))return null!=this.newImage?(this.fileuploaderror="Only images are supported.",this.newImage=r,void(this.fileuploadflag=!0)):(this.fileuploaderror="Only images are supported.",void(this.fileuploadflag=!0));this.newImage=t.target.files[0];const a=new FileReader;a.onload=l=>{this.currentImage=l.target.result},a.readAsDataURL(this.newImage)}save(){const t=this.updateForm.controls.userNameSurname.value,r=t.split(" ")[0],i=t.split(" ")[1],a=this.updateForm.controls.userEmail.value,l=this.updateForm.controls.userCellNumber.value,d=this.updateForm.controls.userGender.value,c=this.updateForm.controls.userLocation.value;if(null!=this.newImage){const $=this.cookie.get("id");this.ref=this.afStorage.ref("UserProfileImage/"+$),this.task=this.ref.put(this.newImage),this.Base64encode(this.newImage).then(B=>{this.updateUser(r,i,a,l,d,c,B).subscribe({next:()=>{this.router.navigate(["settings"])}})})}else this.updateUser(r,i,a,l,d,c,null).subscribe({next:()=>{this.router.navigate(["settings"])}})}updateUser(t,r,i,a,l,d,c){return this.apollo.mutate({mutation:h.Ps`
              mutation{
              updateProfile(updates: {
                oldemail: "${this.originalEmail}",
                userName: "${t}",
                userSurname: "${r}",
                location: "${d}",
                gender: "${l}",
                email: "${i}",
                cellNumber: "${a}",
            }){
              message
            }
          }
        `})}Base64encode(t){return new Promise((r,i)=>{const a=new FileReader;a.onloadend=()=>r(a.result),a.readAsDataURL(t)})}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(s.qu),e.Y36(h._M),e.Y36(C.N),e.Y36(f.F0),e.Y36(N.Q1))},o.\u0275cmp=e.Xpm({type:o,selectors:[["training-buddy-edit-profile"]],decls:63,vars:11,consts:[["title","Edit Profile"],["cols","1","rows","1","rowHeight","2:1"],[1,"container"],["id","fileuploaddiv",1,"my-2",3,"ngStyle"],["id","fileupload","name","fileupload","type","file","accept","image/x-png,image/gif,image/jpeg","hidden","",3,"change"],["fileinput",""],["id","editbutton","mat-fab","",1,"lowright",3,"click"],[1,"mt-3"],[3,"formGroup"],["appearance","outline"],["formControlName","userNameSurname","id","userNameSurname","matInput","","type","text","name","userNameSurname","value","new name"],[4,"ngIf"],["formControlName","userEmail","id","userEmail","matInput","","type","text","name","userEmail"],["formControlName","userCellNumber","id","userCellNumber","matInput","","type","text","name","userCellNumber"],["formControlName","userGender","id","userGender","name","userGender"],["value","M"],["value","F"],["formControlName","userLocation","matInput","","matGoogleMapsAutocomplete","",3,"value","onAutocompleteSelected","onLocationSelected"],[1,"fullhint"],[1,"row","pBy"],[1,"b"],[1,"r"],[1,"y"],[1,"g"],[1,"submitButton","mt-3"],["id","save","mat-raised-button","","color","primary",1,"text-center","ml-1",3,"click"]],template:function(t,r){if(1&t){const i=e.EpF();e._UZ(0,"training-buddy-back-navbar",0),e.TgZ(1,"mat-grid-list",1)(2,"mat-card")(3,"div",2),e._UZ(4,"div",3),e.TgZ(5,"input",4,5),e.NdJ("change",function(l){return r.fileattatched(l)}),e.qZA(),e.TgZ(7,"button",6),e.NdJ("click",function(){return e.CHM(i),e.MAs(6).click()}),e.TgZ(8,"mat-icon"),e._uU(9,"edit"),e.qZA()()(),e.TgZ(10,"mat-card-content",7)(11,"form",8)(12,"mat-form-field",9)(13,"mat-label"),e._uU(14,"Name Surname"),e.qZA(),e._UZ(15,"input",10),e.YNc(16,M,2,1,"mat-error",11),e.qZA(),e.TgZ(17,"mat-form-field",9)(18,"mat-label"),e._uU(19,"Email"),e.qZA(),e._UZ(20,"input",12),e.YNc(21,P,2,1,"mat-error",11),e.qZA(),e.TgZ(22,"mat-form-field",9)(23,"mat-label"),e._uU(24,"Cell Number"),e.qZA(),e._UZ(25,"input",13),e.YNc(26,_,2,1,"mat-error",11),e.qZA(),e.TgZ(27,"mat-form-field",9)(28,"mat-label"),e._uU(29,"Gender"),e.qZA(),e.TgZ(30,"mat-select",14)(31,"mat-option",15),e._uU(32,"Male"),e.qZA(),e.TgZ(33,"mat-option",16),e._uU(34,"Female"),e.qZA()(),e.YNc(35,I,2,1,"mat-error",11),e.qZA(),e.TgZ(36,"mat-form-field",9)(37,"mat-label"),e._uU(38,"location"),e.qZA(),e.TgZ(39,"input",17),e.NdJ("onAutocompleteSelected",function(l){return r.onAutocompleteSelected(l)})("onLocationSelected",function(l){return r.onLocationSelected(l)}),e.qZA(),e.YNc(40,O,2,1,"mat-error",11),e.TgZ(41,"mat-hint",18)(42,"div")(43,"div",19)(44,"p"),e._uU(45,"powered by"),e.qZA(),e._uU(46,"\xa0"),e.TgZ(47,"p",20),e._uU(48,"G"),e.qZA(),e.TgZ(49,"p",21),e._uU(50,"o"),e.qZA(),e.TgZ(51,"p",22),e._uU(52,"o"),e.qZA(),e.TgZ(53,"p",20),e._uU(54,"g"),e.qZA(),e.TgZ(55,"p",23),e._uU(56,"l"),e.qZA(),e.TgZ(57,"p",21),e._uU(58,"e"),e.qZA()()()()(),e.TgZ(59,"div",24)(60,"button",25),e.NdJ("click",function(){return r.save()}),e._uU(61,"Save"),e.qZA()()()()()(),e._UZ(62,"training-buddy-navbar")}2&t&&(e.xp6(1),e.Q6J("@fadeIn",void 0),e.xp6(3),e.Q6J("ngStyle",e.VKq(9,L,"url("+r.currentImage+")")),e.xp6(7),e.Q6J("formGroup",r.updateForm),e.xp6(5),e.Q6J("ngIf",null==r.updateForm.controls.userNameSurname?null:r.updateForm.controls.userNameSurname.errors),e.xp6(5),e.Q6J("ngIf",null==r.updateForm.controls.userEmail?null:r.updateForm.controls.userEmail.errors),e.xp6(5),e.Q6J("ngIf",null==r.updateForm.controls.userCellNumber?null:r.updateForm.controls.userCellNumber.errors),e.xp6(9),e.Q6J("ngIf",r.updateForm.controls.userGender.errors),e.xp6(4),e.s9C("value",r.oldLocation),e.xp6(1),e.Q6J("ngIf",r.updateForm.controls.userLocation.errors))},directives:[A.p,E.Il,Z.a8,g.PC,S.lW,U.Hw,Z.dn,s._Y,s.JL,s.sg,p.KE,p.hX,s.Fj,T.Nt,s.JJ,s.u,g.O5,p.TO,y.gD,F.ey,b.QT,p.bx,x.S],styles:["#fileuploaddiv[_ngcontent-%COMP%]{background-color:#1b1a1b13;position:relative;width:100%;height:250px;background-size:cover;background-repeat:no-repeat;margin-bottom:5%!important}.container[_ngcontent-%COMP%]{position:relative}.lowright[_ngcontent-%COMP%]{position:absolute;top:70%;left:79%}#editbutton[_ngcontent-%COMP%]{background-color:#1b1a1b!important}mat-icon[_ngcontent-%COMP%]{color:#fff}mat-card[_ngcontent-%COMP%]{max-width:400px;width:90vw;margin:2em auto;padding:2em auto;position:absolute;left:50%;transform:translate(-50%);background-color:#fff}#background[_ngcontent-%COMP%]{height:100vh;background-size:cover;background-repeat:no-repeat}.changePassword[_ngcontent-%COMP%]{text-decoration:underline;color:#4350af;margin-left:1%}.changePassword[_ngcontent-%COMP%]:hover{cursor:pointer}mat-form-field[_ngcontent-%COMP%]{display:block}#save[_ngcontent-%COMP%]{width:100%;background-color:#1b1a1b!important}.fullhint[_ngcontent-%COMP%]{width:100%!important}mat-error[_ngcontent-%COMP%]{text-align:right}.b[_ngcontent-%COMP%]{color:#4285f4}.r[_ngcontent-%COMP%]{color:#ea4335}.y[_ngcontent-%COMP%]{color:#fbbc05}.g[_ngcontent-%COMP%]{color:#34a853}p[_ngcontent-%COMP%]{font-size:12px!important}mat-hint[_ngcontent-%COMP%]{text-align:right!important}  .mat-form-field-wrapper{margin-bottom:-1.25em}.row[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:flex-end;margin-bottom:140px}"],data:{animation:[(0,m.X$)("fadeIn",[(0,m.eR)(":enter",[(0,m.jt)(100,(0,m.F4)([(0,m.oB)({opacity:"0"}),(0,m.oB)({opacity:"1"})]))])])]}}),o})()}];let q=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[[f.Bz.forChild(w)],f.Bz]}),o})();var G=n(7918);let J=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({providers:[C.N],imports:[[g.ez,q,G.W,b.Sr,s.UX,s.u5]]}),o})()}}]);