"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[93],{1093:(_t,b,c)=>{c.r(b),c.d(b,{ClientScheduleFeatureModule:()=>mt});var m=c(9808),h=c(5357),u=c(1777),d=c(9444),t=c(5e3),x=c(2160),O=c(5436),w=c(773),y=c(3954),f=c(5245),k=c(7423),v=c(7322),C=c(987);function A(n,s){1&n&&(t.TgZ(0,"div",2),t._UZ(1,"mat-spinner"),t.qZA())}function I(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",14)(1,"div",15)(2,"img",16),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(4).fullWorkoutDetails(null==r?null:r.id)}),t.qZA(),t.TgZ(3,"div",17)(4,"p",18),t._uU(5),t.qZA(),t.TgZ(6,"div",19)(7,"mat-icon"),t._uU(8,"access_time"),t.qZA(),t._uU(9),t.qZA(),t.TgZ(10,"div",19)(11,"mat-icon"),t._uU(12,"location_on"),t.qZA(),t._uU(13),t.qZA(),t.TgZ(14,"div",20)(15,"div",21)(16,"button",22),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(4).acceptInvite(null==r?null:r.organiser,null==r?null:r.id)}),t._uU(17,"Accept"),t.qZA()(),t.TgZ(18,"div",23)(19,"button",22),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(4).rejectInvite(null==r?null:r.organiser,null==r?null:r.id)}),t._uU(20,"Decline"),t.qZA()()()()()()}if(2&n){const e=s.$implicit;t.xp6(2),t.Q6J("src",null==e?null:e.image,t.LSH),t.xp6(3),t.Oqu(null==e?null:e.name),t.xp6(4),t.hij(" ",null==e?null:e.startDate.time," "),t.xp6(4),t.hij(" ",null==e?null:e.startPoint," ")}}function U(n,s){if(1&n&&(t.TgZ(0,"div")(1,"div",11)(2,"h2"),t._uU(3),t.qZA()(),t.YNc(4,I,21,4,"div",13),t.qZA()),2&n){const e=s.$implicit;t.xp6(3),t.AsE(" ",null==e[0]?null:e[0].startDate.day," ",null==e[0]?null:e[0].startDate.month," "),t.xp6(1),t.Q6J("ngForOf",e)}}function q(n,s){if(1&n&&(t.TgZ(0,"div",3)(1,"h2",11),t._uU(2," You have been invited "),t.qZA(),t.YNc(3,U,5,3,"div",12),t.qZA()),2&n){const e=t.oxw(2);t.xp6(3),t.Q6J("ngForOf",e.workoutInvites)}}function P(n,s){1&n&&(t.ynx(0),t._UZ(1,"hr",24),t.BQk()),2&n&&(t.xp6(1),t.Q6J("@swipeLeft",void 0))}function M(n,s){1&n&&(t.ynx(0),t._UZ(1,"hr",25),t.BQk())}function D(n,s){1&n&&(t.ynx(0),t._UZ(1,"hr",25),t.BQk())}function N(n,s){1&n&&(t.ynx(0),t._UZ(1,"hr",24),t.BQk()),2&n&&(t.xp6(1),t.Q6J("@swipeRight",void 0))}function J(n,s){1&n&&(t.TgZ(0,"div",27)(1,"mat-hint",11),t._uU(2,"No workouts scheduled"),t.qZA()())}function W(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",29),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(5).fullWorkoutDetails(null==r?null:r.id)}),t.TgZ(1,"div",15),t._UZ(2,"img",30),t.TgZ(3,"div",17)(4,"p",18),t._uU(5),t.qZA(),t.TgZ(6,"div",19)(7,"mat-icon"),t._uU(8,"access_time"),t.qZA(),t._uU(9),t.qZA(),t.TgZ(10,"div",19)(11,"mat-icon"),t._uU(12,"location_on"),t.qZA(),t._uU(13),t.qZA()()()()}if(2&n){const e=s.$implicit;t.xp6(2),t.Q6J("src",null==e?null:e.image,t.LSH),t.xp6(3),t.Oqu(null==e?null:e.name),t.xp6(4),t.hij(" ",null==e?null:e.startDate.time," "),t.xp6(4),t.hij(" ",null==e?null:e.startPoint," ")}}function Y(n,s){if(1&n&&(t.TgZ(0,"div")(1,"div",11)(2,"h2"),t._uU(3),t.qZA()(),t.YNc(4,W,14,4,"div",28),t.qZA()),2&n){const e=s.$implicit;t.xp6(3),t.lnq(" ",null==e[0]?null:e[0].startDate.day," ",null==e[0]?null:e[0].startDate.month," ",null==e[0]?null:e[0].startDate.year," "),t.xp6(1),t.Q6J("ngForOf",e)}}function S(n,s){if(1&n&&(t.TgZ(0,"div",3),t.YNc(1,Y,5,4,"div",12),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",e.workouts)}}function F(n,s){if(1&n&&(t.ynx(0),t.YNc(1,J,3,0,"div",26),t.YNc(2,S,2,1,"div",1),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!e.upcomingEvents),t.xp6(1),t.Q6J("ngIf",e.upcomingEvents)}}function Q(n,s){1&n&&(t.TgZ(0,"div",27)(1,"mat-hint",11),t._uU(2,"Workouts you finish will apear here."),t.qZA()())}function $(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",29),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(5).fullWorkoutDetails(null==r?null:r.id)}),t.TgZ(1,"div",15),t._UZ(2,"img",30),t.TgZ(3,"div",17)(4,"p",18),t._uU(5),t.qZA(),t.TgZ(6,"div",19)(7,"mat-icon"),t._uU(8,"access_time"),t.qZA(),t._uU(9),t.qZA(),t.TgZ(10,"div",19)(11,"mat-icon"),t._uU(12,"location_on"),t.qZA(),t._uU(13),t.qZA()()()()}if(2&n){const e=s.$implicit;t.xp6(2),t.Q6J("src",null==e?null:e.image,t.LSH),t.xp6(3),t.Oqu(null==e?null:e.name),t.xp6(4),t.hij(" ",null==e?null:e.startDate.time," "),t.xp6(4),t.hij(" ",null==e?null:e.startPoint," ")}}function H(n,s){if(1&n&&(t.TgZ(0,"div")(1,"div",11)(2,"h2"),t._uU(3),t.qZA()(),t.YNc(4,$,14,4,"div",28),t.qZA()),2&n){const e=s.$implicit;t.xp6(3),t.lnq(" ",null==e[0]?null:e[0].startDate.day," ",null==e[0]?null:e[0].startDate.month," ",null==e[0]?null:e[0].startDate.year," "),t.xp6(1),t.Q6J("ngForOf",e)}}function R(n,s){if(1&n&&(t.TgZ(0,"div",3),t.YNc(1,H,5,4,"div",12),t.qZA()),2&n){const e=t.oxw(3);t.xp6(1),t.Q6J("ngForOf",e.workoutHistory)}}function j(n,s){if(1&n&&(t.ynx(0),t.YNc(1,Q,3,0,"div",26),t.YNc(2,R,2,1,"div",1),t.BQk()),2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("ngIf",!e.pastEvents),t.xp6(1),t.Q6J("ngIf",e.pastEvents)}}const V=function(){return["../scheduleworkout"]};function B(n,s){1&n&&(t.TgZ(0,"div")(1,"button",31)(2,"mat-icon"),t._uU(3,"add"),t.qZA()()()),2&n&&(t.xp6(1),t.Q6J("routerLink",t.DdM(1,V)))}function E(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",3)(1,"mat-grid-list",4),t.YNc(2,q,4,1,"div",1),t.TgZ(3,"div",5)(4,"div",6)(5,"h4",7,8),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleUpcomingWorkouts()}),t._uU(7,"Upcoming workouts"),t.qZA(),t.YNc(8,P,2,1,"ng-container",9),t.YNc(9,M,2,0,"ng-container",9),t.qZA(),t.TgZ(10,"div",6)(11,"h4",7,10),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleWorkoutHistory()}),t._uU(13,"History"),t.qZA(),t.YNc(14,D,2,0,"ng-container",9),t.YNc(15,N,2,1,"ng-container",9),t.qZA()(),t.YNc(16,F,3,2,"ng-container",9),t.YNc(17,j,3,2,"ng-container",9),t.YNc(18,B,4,2,"div",9),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(2),t.Q6J("ngIf",e.invitesAvailable),t.xp6(6),t.Q6J("ngIf",e.toggle),t.xp6(1),t.Q6J("ngIf",!e.toggle),t.xp6(5),t.Q6J("ngIf",e.toggle),t.xp6(1),t.Q6J("ngIf",!e.toggle),t.xp6(1),t.Q6J("ngIf",e.toggle),t.xp6(1),t.Q6J("ngIf",!e.toggle),t.xp6(1),t.Q6J("ngIf",e.toggle)}}let L=(()=>{class n{constructor(e,i,o,r,a){this.apollo=e,this.cookie=i,this.activated=o,this.router=r,this.cookieService=a,this.upcomingEvents=!1,this.pastEvents=!1,this.loading=!0,this.invitesAvailable=!1,this.workoutsLoaded=!1,this.workoutsCount=0,this.toggle=!0,this.email=this.cookieService.get("email")}ngOnInit(){this.getData(this.email)}getWorkouts(e){return this.apollo.query({query:d.Ps`
        query{
          getScheduleWorkout(email: "${e}"){
            title,
            id,
            startTime,
            activityType,
            startPoint,
            proposedDistance,
            proposedDuration
            }
        }`})}getWorkoutHistory(e){return this.apollo.query({query:d.Ps`
        query{
          getWorkoutHistory(email: "${e}"){
            title,
            id,
            startTime,
            activityType,
            startPoint,
            proposedDistance,
            proposedDuration
            }
        }`})}getInvites(e){return this.apollo.query({query:d.Ps`
        query{
          getIncomingInvites(email: "${e}"){
            sender,
            receivers,
            workout{
              title,
              id,
              startTime,
              organiser,
              participants{
                userName,
                userSurname,
                location,
                longitude,
                latitude,
                stravaToken,
                dob,
                gender,
                email,
                cellNumber,
                id,
                bio,
                metrics{
                  lift,
                  run,
                  swim,
                  ride
                },
                buddies,
                distance
              }
              activityType,
              startPoint,
              proposedDistance,
              proposedDuration
            }
          }
        }
      `})}getUserName(e){return this.apollo.query({query:d.Ps`
        query{
          getOne(email: "${e}"){
            userName
          }
        }`})}getData(e){this.getInvites(e).subscribe({next:i=>{const o=[];if(i.data.getIncomingInvites.map(l=>{o.push(this.convertInvitedToCard(l))}),0==o.length)return;o.sort(function(l,g){return l.startDate.timestamp-g.startDate.timestamp});const r=[[]];let a=0,p=o[0].startDate.day;for(let l=0;l<o.length;l++)o[l].startDate.day==p||(p=o[l].startDate.day,a++,r.push([])),r[a].push(o[l]);this.workoutInvites=r,0!=this.workoutInvites.length&&(this.invitesAvailable=!0)}}),this.getWorkouts(e).subscribe({next:i=>{const o=[];if(i.data.getScheduleWorkout.map(r=>{o.push(this.convertWorkoutToCard(r))}),0!=o.length){o.sort(function(l,g){return l.startDate.timestamp-g.startDate.timestamp});const r=[[]];let a=0,p=o[0].startDate.day;for(let l=0;l<o.length;l++)o[l].startDate.day==p||(p=o[l].startDate.day,a++,r.push([])),r[a].push(o[l]);this.workouts=r,this.workoutsLoaded=!0,this.workoutsCount=this.workouts.length,0!=this.workoutsCount&&(this.upcomingEvents=!0)}this.loading=!1}}),this.getWorkoutHistory(e).subscribe({next:i=>{const o=[];if(i.data.getWorkoutHistory.map(r=>{o.push(this.convertWorkoutToCard(r))}),0!=o.length){o.sort(function(l,g){return g.startDate.timestamp-l.startDate.timestamp});const r=[[]];let a=0,p=o[0].startDate.day;for(let l=0;l<o.length;l++)o[l].startDate.day==p||(p=o[l].startDate.day,a++,r.push([])),r[a].push(o[l]);this.workoutHistory=r,0!=this.workoutHistory.length&&(this.pastEvents=!0)}this.loading=!1}})}convertInvitedToCard(e){return{organiser:e.sender,name:e.workout.title,id:e.workout.id,startPoint:e.workout.startPoint,startDate:this.startDateTime(e.workout.startTime),image:this.image(e.workout.activityType)}}convertWorkoutToCard(e){return{name:e.title,id:e.id,startPoint:e.startPoint,startDate:this.startDateTime(e.startTime),image:this.image(e.activityType)}}startDateTime(e){const i=new Date(1e3*Number(e)),r=new m.uU("en-US").transform(i,"HH:mm");return{timestamp:e,day:i.getDate(),month:["January","February","March","April","May","June","July","August","September","October","November","December"][i.getMonth()],year:i.getFullYear(),time:r}}image(e){return"run"==e?"https://img.icons8.com/ios/50/000000/running.png":"ride"==e?"https://img.icons8.com/ios-filled/50/000000/bicycle.png":"swim"==e?"https://img.icons8.com/ios/50/000000/swimming.png":"https://img.icons8.com/ios/50/000000/dumbbell--v1.png"}fullWorkoutDetails(e){this.router.navigate([`schedule/${e}`])}acceptInvite(e,i){this.apollo.mutate({mutation:d.Ps`
        mutation{
          acceptInvite(
            email: "${this.email}",
            sender: "${e}",
            workoutID: "${i}"
          ){
          message
          }
      }
    `}).subscribe({next:()=>{this.workoutInvites.map((o,r)=>{console.log(o[0]),o.id==i&&(this.workoutInvites.splice(r,1),console.log("sheeeeeesh"))})}})}rejectInvite(e,i){this.apollo.mutate({mutation:d.Ps`
        mutation{
          rejectInvite(
            email: "${this.email}",
            sender: "${e}",
            workoutID: "${i}"
          ){
          message
          }
      }
    `}).subscribe({next:()=>{this.getData(this.email)}})}toggleUpcomingWorkouts(){this.toggle=!0}toggleWorkoutHistory(){this.toggle=!1}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(d._M),t.Y36(x.N),t.Y36(h.gz),t.Y36(h.F0),t.Y36(x.N))},n.\u0275cmp=t.Xpm({type:n,selectors:[["training-buddy-view-schedule"]],decls:4,vars:2,consts:[["class","spinner","id","pagespinner",4,"ngIf"],["class","px-4",4,"ngIf"],["id","pagespinner",1,"spinner"],[1,"px-4"],["cols","1","rows","1","rowHeight","2:1",1,"pb-20"],[1,"row","space-around","mt-5"],[1,"fullwidth","text-center"],[1,"link",3,"click"],["toggleCurrentWorkouts",""],[4,"ngIf"],["togglWorkoutHistory",""],[1,"text-center"],[4,"ngFor","ngForOf"],["class","px-4 py-16 mx-auto my-4 bg-white  rounded-xl shadow-md p-[0px] pb-[4px] m-[0px] pt-[4px] shadow- sm:max-w-xl sm:py-14 md:max-w-full md:px-24 md:p-[3px] lg:max-w-screen-xl lg:px-8",4,"ngFor","ngForOf"],[1,"px-4","py-16","mx-auto","my-4","bg-white","rounded-xl","shadow-md","p-[0px]","pb-[4px]","m-[0px]","pt-[4px]","shadow-","sm:max-w-xl","sm:py-14","md:max-w-full","md:px-24","md:p-[3px]","lg:max-w-screen-xl","lg:px-8"],[1,"flex","p-[0px]","m-[0px]","mb-2"],["alt","No alt",1,"my-auto","object-scale-down","w-20","h-20","mr-4","rounded-full","shadow","bg-white","border-4","border-sky-200","border-x-sky-500",3,"src","click"],[1,"flex","flex-col","justify-center","w-full"],[1,"text-lg","font-bold","text-slate-900","dark:text-slate-800","text-left"],[1,"with-icon"],[1,"grid","grid-cols-2","mt-2"],[1,"flex","request-buttons"],["color","primary","mat-raised-button","",1,"text-white",3,"click"],[1,"flex","request-buttons","flex-end"],[1,"hrdark","animation-perform"],[1,"hrlight","animation-perform"],["class","my-6",4,"ngIf"],[1,"my-6"],["class","px-4 py-16 mx-auto my-4 bg-white rounded-xl shadow-md p-[0px] pb-[4px] m-[0px] pt-[4px] shadow- sm:max-w-xl sm:py-14 md:max-w-full md:px-24 md:p-[3px] lg:max-w-screen-xl lg:px-8  ",3,"click",4,"ngFor","ngForOf"],[1,"px-4","py-16","mx-auto","my-4","bg-white","rounded-xl","shadow-md","p-[0px]","pb-[4px]","m-[0px]","pt-[4px]","shadow-","sm:max-w-xl","sm:py-14","md:max-w-full","md:px-24","md:p-[3px]","lg:max-w-screen-xl","lg:px-8",3,"click"],["alt","No alt",1,"my-auto","object-scale-down","w-20","h-20","mr-4","rounded-full","shadow","bg-white","border-4","border-sky-200","border-x-sky-500",3,"src"],["id","addbutton","color","primary","mat-fab","",3,"routerLink"]],template:function(e,i){1&e&&(t._UZ(0,"training-buddy-unsigned-navbar"),t.YNc(1,A,2,0,"div",0),t.YNc(2,E,19,8,"div",1),t._UZ(3,"training-buddy-navbar")),2&e&&(t.xp6(1),t.Q6J("ngIf",i.loading),t.xp6(1),t.Q6J("ngIf",!i.loading))},directives:[O.B,m.O5,w.Ou,y.Il,m.sg,f.Hw,k.lW,v.bx,h.rH,C.S],styles:["#addbutton[_ngcontent-%COMP%]{position:fixed;top:80%;left:80%}.text-center[_ngcontent-%COMP%]{text-align:center}#pagespinner[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.eventpic[_ngcontent-%COMP%]{background-color:#1b1a1b13;height:50px;width:50px;border-radius:50%;background-size:80%;background-position:center;background-repeat:no-repeat;margin-bottom:5%!important}mat-form-field[_ngcontent-%COMP%]{display:block}.spinner[_ngcontent-%COMP%]     .mat-progress-spinner circle, .mat-spinner[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{stroke:#0284c7!important}mat-spinner[_ngcontent-%COMP%]{margin:auto}h2[_ngcontent-%COMP%]{margin-bottom:0%!important}.row[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.space-between[_ngcontent-%COMP%]{justify-content:space-between}.align-content[_ngcontent-%COMP%]{align-items:center}.cursor[_ngcontent-%COMP%]:hover{cursor:pointer}.truncate[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:70%}.animation-perform[_ngcontent-%COMP%]{will-change:auto}.hrlight[_ngcontent-%COMP%]{height:1.5px;background-color:#e4e6eb;border:none}.hrdark[_ngcontent-%COMP%]{height:1.5px;background-color:#1b1a1b!important;border:none}.fullwidth[_ngcontent-%COMP%]{width:100%}.with-icon[_ngcontent-%COMP%]{display:flex;align-items:center;text-overflow:ellipsis;overflow:hidden}.request-buttons[_ngcontent-%COMP%] > button[_ngcontent-%COMP%]{width:96%!important}"],data:{animation:[(0,u.X$)("swipeRight",[(0,u.eR)(":enter",[(0,u.jt)(120,(0,u.F4)([(0,u.oB)({transform:"translate3d(-100%, 0, 0)",visibility:"visible"}),(0,u.oB)({transform:"translate3d(0, 0, 0)"})]))]),(0,u.eR)(":leave",[])]),(0,u.X$)("swipeLeft",[(0,u.eR)(":enter",[(0,u.jt)(120,(0,u.F4)([(0,u.oB)({transform:"translate3d(100%, 0, 0)",visibility:"visible"}),(0,u.oB)({transform:"translate3d(0, 0, 0)"})]))]),(0,u.eR)(":leave",[])]),(0,u.X$)("fadeIn",[(0,u.eR)(":enter",[(0,u.jt)(120,(0,u.F4)([(0,u.oB)({opacity:"0"}),(0,u.oB)({opacity:"1"})]))])])]}}),n})();var Z=c(8505),_=c(8966),z=c(1271);let X=(()=>{class n{constructor(e,i,o,r){this.dialogRef=e,this.apollo=i,this.snackBar=o,this.user=r,this.numberofStars=0}ngOnInit(){console.log(this.user)}onNoClick(){this.dialogRef.close()}setStars(e){this.numberofStars=e,console.log("setting stars to "+e)}getFill(e){return e<this.numberofStars?"259.3 17.8L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0z":"M528.1 171.5L382 150.2 316.7 17.8c-11.7-23.6-45.6-23.9-57.4 0L194 150.2 47.9 171.5c-26.2 3.8-36.7 36.1-17.7 54.6l105.7 103-25 145.5c-4.5 26.3 23.2 46 46.4 33.7L288 439.6l130.7 68.7c23.2 12.2 50.9-7.4 46.4-33.7l-25-145.5 105.7-103c19-18.5 8.5-50.8-17.7-54.6zM388.6 312.3l23.7 138.4L288 385.4l-124.3 65.3 23.7-138.4-100.6-98 139-20.2 62.2-126 62.2 126 139 20.2-100.6 98z"}greater(e){return this.numberofStars>=e}add(){this.apollo.mutate({mutation:d.Ps`
      mutation{
        addRating(
          email:"${this.user.email}",
          rating: ${this.numberofStars},
        ){
          message
        }
      }
      `}).subscribe({next:e=>{console.log(e.data.addRating.message),this.snackBar.open("Success!","",{duration:2e3}),this.dialogRef.close()}})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_.so),t.Y36(d._M),t.Y36(z.ux),t.Y36(_.WI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["training-buddy-rating"]],decls:26,vars:3,consts:[[1,""],[1,"right-align"],[3,"click"],[1,"py-3","sm:max-w-xl","sm:mx-auto"],[1,"min-w-1xl","flex","flex-col","rounded-xl"],[1,"w-full","flex","flex-col","items-center"],[1,"flex","flex-col","items-center","py-6","space-y-3"],[1,"text-lg","text-gray-800","text-center"],["alt","No alt",1,"object-cover","w-20","h-20","m-4","rounded-full","shadow","bg-blue-100",3,"src"],[1,"rating"],["type","radio","name","rating","id","r1",3,"click"],["for","r1"],["type","radio","name","rating","id","r2",3,"click"],["for","r2"],["type","radio","name","rating","id","r3",3,"click"],["for","r3"],["type","radio","name","rating","id","r4",3,"click"],["for","r4"],["type","radio","name","rating","id","r5",3,"click"],["for","r5"],[1,"w-3/4","flex","flex-col"],["mat-raised-button","","color","primary",1,"py-3","my-8","text-lg","bg-black","rounded-xl","text-white",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"mat-icon",2),t.NdJ("click",function(){return i.onNoClick()}),t._uU(3," close"),t.qZA()(),t.TgZ(4,"div",3)(5,"div",4)(6,"div",5)(7,"div",6)(8,"span",7),t._uU(9),t.qZA()(),t.TgZ(10,"div"),t._UZ(11,"img",8),t.qZA(),t.TgZ(12,"div",9)(13,"input",10),t.NdJ("click",function(){return i.setStars(5)}),t.qZA(),t._UZ(14,"label",11),t.TgZ(15,"input",12),t.NdJ("click",function(){return i.setStars(4)}),t.qZA(),t._UZ(16,"label",13),t.TgZ(17,"input",14),t.NdJ("click",function(){return i.setStars(3)}),t.qZA(),t._UZ(18,"label",15),t.TgZ(19,"input",16),t.NdJ("click",function(){return i.setStars(2)}),t.qZA(),t._UZ(20,"label",17),t.TgZ(21,"input",18),t.NdJ("click",function(){return i.setStars(1)}),t.qZA(),t._UZ(22,"label",19),t.qZA(),t.TgZ(23,"div",20)(24,"button",21),t.NdJ("click",function(){return i.add()}),t._uU(25,"Rate now"),t.qZA()()()()()()),2&e&&(t.xp6(9),t.AsE("How would you rate ",i.user.userName," ",i.user.userSurname,"?"),t.xp6(2),t.s9C("src",i.user.image,t.LSH))},directives:[f.Hw,k.lW],styles:['@charset "UTF-8";.rating[_ngcontent-%COMP%]{margin:10px auto;width:200px}.rating[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{float:right}@keyframes pulse{50%{color:#5e5e5e;text-shadow:0 0 15px #777777}}.rating[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{height:40px;width:20%;display:block;position:relative;cursor:pointer}.rating[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-of-type(5):after{animation-delay:.25s}.rating[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-of-type(4):after{animation-delay:.2s}.rating[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-of-type(3):after{animation-delay:.15s}.rating[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-of-type(2):after{animation-delay:.1s}.rating[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-of-type(1):after{animation-delay:.05s}.rating[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:after{transition:all .4s ease-out;-webkit-font-smoothing:antialiased;position:absolute;content:"\\2606";color:#444;top:0;left:0;width:100%;height:100%;text-align:center;font-size:40px;animation:.5s pulse ease}.rating[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover:after{color:#5e5e5e;text-shadow:0 0 15px #5e5e5e;transform:scale(1.1)}.rating[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.rating[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]:after, .rating[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked ~ label[_ngcontent-%COMP%]:after{content:"\\2605";color:#f9bf3b;text-shadow:0 0 20px #F9BF3B}body[_ngcontent-%COMP%]{background-color:#111}.right-align[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:flex-end}']}),n})();var T=c(4585),K=c(7531);function G(n,s){1&n&&(t.TgZ(0,"div",6),t._UZ(1,"mat-spinner"),t.qZA())}function tt(n,s){1&n&&(t.TgZ(0,"div",13)(1,"mat-hint",14),t._uU(2,"No buddies available to add"),t.qZA()())}function et(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"tr")(1,"td",15)(2,"div",16)(3,"div",17),t._UZ(4,"img",18),t.qZA(),t.TgZ(5,"div",19),t._uU(6),t.qZA()()(),t.TgZ(7,"td",15)(8,"button",20),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(2).sendRequest(null==r?null:r.email)}),t.TgZ(9,"mat-icon"),t._uU(10,"add_circle"),t.qZA()()()()}if(2&n){const e=s.$implicit;t.xp6(4),t.s9C("src",null==e?null:e.image,t.LSH),t.xp6(2),t.AsE("",null==e?null:e.userName," ",null==e?null:e.userSurname,"")}}function nt(n,s){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,tt,3,0,"div",7),t.TgZ(2,"div",8)(3,"div",9)(4,"table",10)(5,"tbody",11),t.YNc(6,et,11,3,"tr",12),t.qZA()()()()()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.noBuddies),t.xp6(5),t.Q6J("ngForOf",e.buddies)}}let it=(()=>{class n{constructor(e,i,o,r,a){this.dialogRef=e,this.apollo=i,this.cookieService=o,this.afStorage=r,this.workoutID=a,this.loading=!0,this.noBuddies=!1,this.email=this.cookieService.get("email")}ngOnInit(){console.log("sheeesh"),console.log(this.workoutID),this.getData(this.email)}onNoClick(){this.dialogRef.close()}getData(e){this.getBuddies(e).subscribe({next:i=>{this.fetchImages(i.data.getConnections).then(o=>{this.buddies=o,this.buddiesOriginal=o}),this.loading=!1,this.buddyCount=this.buddies.length,0==this.buddyCount&&(this.noBuddies=!0)}})}getBuddies(e){return this.apollo.query({query:d.Ps`query{
        getConnections(
          email: "${e}",
      ){
        userName,
        userSurname,
        location,
        longitude,
        latitude,
        stravaToken,
        dob,
        gender,
        email,
        cellNumber,
        bio,
        metrics{lift , ride , run , swim},
        buddies,
        id
      }
      }
      `})}sendRequest(e){this.apollo.mutate({mutation:d.Ps`
        mutation{
        sendInvite(
          email: "${this.email}",
          receiver:"${e}",
          workoutID: "${this.workoutID}"
        ){
          message
        }
      }
    `}).subscribe({next:i=>{console.log(i.data.sendInvite.message),this.buddiesOriginal.map((o,r)=>{o.email==e&&(1==this.buddyCount?(this.buddiesOriginal=null,this.buddies=null,this.buddyCount=0,this.noBuddies=!0):(this.buddiesOriginal.splice(r,1),this.buddies=this.buddiesOriginal,console.log("here")))}),"Failure"==i.data.sendInvite.message&&this.createInvite(e)}})}createInvite(e){this.apollo.mutate({mutation:d.Ps`
        mutation{
          createInvite(
            email: "${this.email}",
            workoutID: "${this.workoutID}"
          ){
            message
          }
      }
      `}).subscribe({next:i=>{console.log(i.data.createInvite.message),this.sendRequest(e)}})}fetchImages(e){return new Promise((i,o)=>{const r=[];e.forEach(a=>{this.afStorage.ref(`UserProfileImage/${a.id}`).getDownloadURL().pipe((0,Z.b)(p=>{const l={image:p},g=Object.assign(Object.assign({},a),l);r.push(g)})).subscribe()}),i(r)})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_.so),t.Y36(d._M),t.Y36(x.N),t.Y36(T.Q1),t.Y36(_.WI))},n.\u0275cmp=t.Xpm({type:n,selectors:[["training-buddy-workout-invite"]],decls:10,vars:2,consts:[[1,"right-align"],[3,"click"],["appearance","outline",1,"mt-3","w-full"],["id","search","matInput","","placeholder","Search for buddies to add","name","search"],["class","spinner","id","pagespinner",4,"ngIf"],[4,"ngIf"],["id","pagespinner",1,"spinner"],["class","my-6",4,"ngIf"],[1,"w-full","max-w-2xl","mx-auto","bg-white"],[1,"p-3"],[1,"table-auto","w-full"],[1,"text-sm","divide-y","divide-gray-100"],[4,"ngFor","ngForOf"],[1,"my-6"],[1,"text-center"],[1,"p-2","whitespace-nowrap"],[1,"flex","items-center"],[1,"w-10","h-10","flex-shrink-0","mr-2","sm:mr-3"],["width","40","height","40","alt","pic",1,"rounded-full","w-10","h-10",3,"src"],[1,"font-medium","text-gray-800"],[1,"text-center","mx-5","button",3,"click"]],template:function(e,i){1&e&&(t.TgZ(0,"mat-dialog-content")(1,"div",0)(2,"mat-icon",1),t.NdJ("click",function(){return i.onNoClick()}),t._uU(3," close"),t.qZA()(),t.TgZ(4,"mat-form-field",2)(5,"mat-label"),t._uU(6,"Search"),t.qZA(),t._UZ(7,"input",3),t.qZA(),t.YNc(8,G,2,0,"div",4),t.YNc(9,nt,7,2,"div",5),t.qZA()),2&e&&(t.xp6(8),t.Q6J("ngIf",i.loading),t.xp6(1),t.Q6J("ngIf",!i.loading))},directives:[_.xY,f.Hw,v.KE,v.hX,K.Nt,m.O5,w.Ou,v.bx,m.sg],styles:[".pic[_ngcontent-%COMP%]{background-color:#1b1a1b13;height:20px;width:20px;border-radius:50%;background-size:80%;background-position:center;background-repeat:no-repeat;margin-bottom:5%!important}#pagespinner[_ngcontent-%COMP%]{margin:auto;width:50%;padding:10px}.spinner[_ngcontent-%COMP%]     .mat-progress-spinner circle, .mat-spinner[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{stroke:#0284c7!important}.right-align[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:flex-end}"]}),n})();var ot=c(6971);function rt(n,s){1&n&&(t.TgZ(0,"div",4),t._UZ(1,"mat-spinner"),t.qZA())}function st(n,s){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",23),t.NdJ("click",function(){return t.CHM(e),t.oxw(2).openDialog()}),t.TgZ(2,"mat-icon"),t._uU(3,"add"),t.qZA()(),t.BQk()}}function at(n,s){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"button",28),t.NdJ("click",function(){t.CHM(e);const o=t.oxw().$implicit;return t.oxw(2).rateUser(o)}),t._uU(2,"Rate"),t.qZA(),t.BQk()}}function lt(n,s){1&n&&(t.ynx(0),t.TgZ(1,"p",29),t._uU(2,"You can't rate yourself"),t.qZA(),t.BQk())}function ct(n,s){if(1&n){const e=t.EpF();t.TgZ(0,"div",24)(1,"img",25),t.NdJ("click",function(){const r=t.CHM(e).$implicit;return t.oxw(2).viewProfile(r.id)}),t.qZA(),t.TgZ(2,"div",26)(3,"p",27),t._uU(4),t.qZA(),t.YNc(5,at,3,0,"ng-container",19),t.YNc(6,lt,3,0,"ng-container",19),t.qZA()()}if(2&n){const e=s.$implicit,i=t.oxw(2);t.xp6(1),t.s9C("src",e.image,t.LSH),t.xp6(3),t.AsE("",e.userName," ",e.userSurname,""),t.xp6(1),t.Q6J("ngIf",!i.isCurrentUser(e)),t.xp6(1),t.Q6J("ngIf",i.isCurrentUser(e))}}function ut(n,s){if(1&n&&(t.TgZ(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8)(4,"p",9),t._uU(5),t.qZA()(),t.TgZ(6,"div",10)(7,"dl",11)(8,"div",12)(9,"dt",13)(10,"p",14)(11,"mat-icon"),t._uU(12,"date_range"),t.qZA(),t._uU(13," When"),t.qZA()(),t.TgZ(14,"dd",15)(15,"p",13),t._uU(16),t.qZA()()(),t.TgZ(17,"div",12)(18,"dt",13)(19,"p",14)(20,"mat-icon"),t._uU(21," directions_bike"),t.qZA(),t._uU(22," Activity Type"),t.qZA()(),t.TgZ(23,"dd",15)(24,"p",13),t._uU(25),t.qZA()()(),t.TgZ(26,"div",12)(27,"dt",13)(28,"p",14)(29,"mat-icon"),t._uU(30," location_on"),t.qZA(),t._uU(31," Where"),t.qZA()(),t.TgZ(32,"dd",15)(33,"p",13),t._uU(34),t.qZA()()(),t.TgZ(35,"div",12)(36,"dt",13)(37,"p",14)(38,"mat-icon"),t._uU(39,"timelapse"),t.qZA(),t._uU(40," Duration"),t.qZA()(),t.TgZ(41,"dd",15)(42,"p",13),t._uU(43),t.qZA()()(),t.TgZ(44,"div",12)(45,"dt",13)(46,"p",14)(47,"mat-icon"),t._uU(48,"date_range"),t.qZA(),t._uU(49," Distance"),t.qZA()(),t.TgZ(50,"dd",15)(51,"p",13),t._uU(52),t.qZA()()(),t.TgZ(53,"div",12)(54,"dt",13)(55,"p",14)(56,"mat-icon"),t._uU(57," email"),t.qZA(),t._uU(58," Organiser"),t.qZA()(),t.TgZ(59,"dd",15)(60,"p",13),t._uU(61),t.qZA()()()()()()(),t.TgZ(62,"div",16)(63,"div",17)(64,"p",18),t._uU(65,"Participants"),t.qZA(),t.YNc(66,st,4,0,"ng-container",19),t.TgZ(67,"p",20),t._uU(68,"These are all the participants of your workout please rate their kindness."),t.qZA()(),t.TgZ(69,"div",21),t.YNc(70,ct,7,5,"div",22),t.qZA()()()),2&n){const e=t.oxw();t.xp6(5),t.Oqu(null==e.workout?null:e.workout.title),t.xp6(11),t.HOy("",null==e.workout?null:e.workout.startTime.day," ",null==e.workout?null:e.workout.startTime.month," ",null==e.workout?null:e.workout.startTime.year," ",null==e.workout?null:e.workout.startTime.time,""),t.xp6(9),t.hij(" ",null==e.workout?null:e.workout.activityType," "),t.xp6(9),t.hij(" ",null==e.workout?null:e.workout.startPoint," "),t.xp6(9),t.hij(" ",null==e.workout?null:e.workout.proposedDuration," "),t.xp6(9),t.hij(" ",null==e.workout?null:e.workout.proposedDistance," km"),t.xp6(9),t.Oqu(null==e.workout?null:e.workout.organiser),t.xp6(5),t.Q6J("ngIf",e.organiser),t.xp6(4),t.Q6J("ngForOf",e.participants)}}const dt=[{path:"",component:L},{path:":workoutID",component:(()=>{class n{constructor(e,i,o,r,a,p){this.activated=e,this.cookieService=i,this.apollo=o,this.afStorage=r,this.dialog=a,this.router=p,this.loading=!0,this.organiser=!1,this.email=i.get("email")}ngOnInit(){this.activated.params.subscribe(e=>{this.workoutID=null==e?void 0:e.workoutID,console.log(this.workoutID),this.getData()})}getWorkout(){return this.apollo.query({query:d.Ps`
      query{
        getWorkout(
          email:"${this.email}",
          workoutID: "${this.workoutID}",
        ){
          title,
          startTime,
          organiser,
          participants{
            userName,
            userSurname,
            id,
            email
          },
          activityType,
          startPoint,
          proposedDistance,
          proposedDuration,
        }
      }`})}getData(){this.getWorkout().subscribe({next:e=>{this.fetchImages(e.data.getWorkout.participants).then(i=>{console.log(i),this.participants=i}),this.workout=this.convertQuery(e.data.getWorkout),console.log("organiser",this.workout.organiser),console.log("this email",this.email),this.workout.organiser===this.email&&(this.organiser=!0),this.loading=!1}})}viewProfile(e){console.log(e),this.router.navigate([`/profile/${e}`])}convertQuery(e){return{title:e.title,startTime:this.startDateTime(e.startTime),organiser:e.organiser,activityType:e.activityType,startPoint:e.startPoint,proposedDistance:e.proposedDistance,proposedDuration:e.proposedDuration}}fetchImages(e){return new Promise((i,o)=>{const r=[];e.forEach(a=>{this.afStorage.ref(`UserProfileImage/${a.id}`).getDownloadURL().pipe((0,Z.b)(p=>{const l={image:p},g=Object.assign(Object.assign({},a),l);r.push(g)})).subscribe()}),i(r)})}startDateTime(e){const i=new Date(1e3*Number(e)),r=new m.uU("en-US").transform(i,"HH:mm");return{day:i.getDate(),month:["January","February","March","April","May","June","July","August","September","October","November","December"][i.getMonth()],year:i.getFullYear(),time:r}}openDialog(){this.dialog.open(it,{minWidth:"300px",maxWidth:"80%",data:this.workoutID}).afterClosed().subscribe(i=>{console.log("The dialog was closed")})}rateUser(e){this.dialog.open(X,{width:"350px",data:e}).afterClosed().subscribe(o=>{console.log("The dialog was closed")})}isCurrentUser(e){return e.email===this.email}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(h.gz),t.Y36(x.N),t.Y36(d._M),t.Y36(T.Q1),t.Y36(_.uw),t.Y36(h.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["training-buddy-workout"]],decls:5,vars:2,consts:[["title","Event"],["class","spinner","id","pagespinner",4,"ngIf"],["cols","1","rows","1","rowHeight","2:1",1,"pb-20"],["class","md:grid md:grid-cols-2 md:gap-x-2 max-h-max",4,"ngIf"],["id","pagespinner",1,"spinner"],[1,"md:grid","md:grid-cols-2","md:gap-x-2","max-h-max"],[1,"bg-slate-200","dark:divide-undefined","dark:divide-undefined","rounded-xl","shadow-md","p-4","m-4"],[1,"max-w-6xl","mx-auto","px-4"],[1,"text-center"],[1,"mt-2","pt-5","text-3xl","font-extrabold","tracking-tight","text-gray-900","dark:divide-undefined","dark:text-gray-900"],[1,"mt-4"],[1,"space-y-2","md:space-y-0","md:grid","md:grid-cols-2","md:gap-x-8","md:gap-y-10"],[1,"relative"],[1,""],[1,"with-icon","text-xl","leading-6","text-gray-600"],[1,"mt-2","text-base"],[1,"bg-slate-600","m-4","sm:max-w-xl","p-4","md:max-w-full","md:px-24","lg:max-w-screen-xl","lg:px-8","rounded-xl","shadow-md"],[1,"max-w-xl","mb-10","md:mx-auto","text-center","lg:max-w-2xl","md:mb-12","items-center"],[1,"mt-2","pt-4","text-3xl","font-extrabold","tracking-tight","text-gray-900","dark:divide-undefined","dark:text-gray-900"],[4,"ngIf"],[1,"md:text-lg","mt-10"],[1,"pb-4","grid","gap-10","row-gap-8","mx-auto","sm:row-gap-10","lg:max-w-screen-lg","sm:grid-cols-1","lg:grid-cols-2"],["class","flex rounded-xl shadow-md p-4 min-w-full bg-white",4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",1,"text-white","text-sm","rounded-lg","m-4",3,"click"],[1,"flex","rounded-xl","shadow-md","p-4","min-w-full","bg-white"],["alt","No alt",1,"object-cover","w-20","h-20","mr-4","rounded-full","shadow","bg-blue-100",3,"src","click"],[1,"flex","flex-col","justify-center"],[1,"text-lg","font-bold","text-slate-900","dark:text-slate-900"],["mat-raised-button","","color","primary",1,"w-10",3,"click"],[1,"text-sm","text-gray-600","dark:text-gray-600"]],template:function(e,i){1&e&&(t._UZ(0,"training-buddy-back-navbar",0),t.YNc(1,rt,2,0,"div",1),t.TgZ(2,"mat-grid-list",2),t.YNc(3,ut,71,12,"div",3),t.qZA(),t._UZ(4,"training-buddy-navbar")),2&e&&(t.xp6(1),t.Q6J("ngIf",i.loading),t.xp6(2),t.Q6J("ngIf",!i.loading))},directives:[ot.p,m.O5,w.Ou,y.Il,f.Hw,k.lW,m.sg,C.S],styles:["#pagespinner[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}.spinner[_ngcontent-%COMP%]     .mat-progress-spinner circle, .mat-spinner[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{stroke:#1b1a1b}.with-icon[_ngcontent-%COMP%]{display:flex;align-items:center;text-overflow:ellipsis;overflow:hidden}"]}),n})()}];let gt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[h.Bz.forChild(dt)],h.Bz]}),n})();var pt=c(7918);let mt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[x.N,{provide:_.so,useValue:[]},{provide:_.WI,useValue:[]}],imports:[[m.ez,gt,pt.W,_.Is]]}),n})()}}]);